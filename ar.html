<html>
  <head>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
<!--         <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script> -->
    <script>
      var campos = new THREE.Vector3();
      var a = 1;
      function add() {
        a++;
        document.getElementById("p1").innerHTML = a;
      }
      function camPos() {
        
        // campos = document.getElementById("camera").object3D.getWorldPosition();
        // window.parent.passPos(Pos,rotat);
        // document.getElementById("p1").innerHTML = campos;
      }

      // setInterval(camPos, 1000);
    </script>
    <script>
      var test = 123;
      var Pos = new THREE.Vector3();
      var rotat = new THREE.Quaternion();
      var mx = new THREE.Matrix4();
      function updatePos() {
        document.getElementById("p1").innerHTML =
          "Position: " + Pos.x + " " + Pos.y + " " + Pos.z;
        window.parent.passPos(Pos,rotat);
      }
      setInterval(updatePos, 500);
      AFRAME.registerComponent("track-camera", {
        tick: (function() {
          const position = new THREE.Vector3();
          const rotation = new THREE.Quaternion();
          const euler = new THREE.Euler();
          const matrix = new THREE.Matrix4();
          return function() {
            // local
            // var position = this.el.getAttribute('position');
            // var rotation = this.el.getAttribute('rotation');
            // console.log("Position: " + position.x + " " + position.y + " " + position.z);
            // console.log("Rotation: " + rotation.x + " " + rotation.y + " " + rotation.z);

            this.el.object3D.updateMatrixWorld();
            position.setFromMatrixPosition(this.el.object3D.matrixWorld); // Vector3
            rotation.setFromRotationMatrix(
              matrix.extractRotation(this.el.object3D.matrixWorld)
            );

            // console.log(
            //   "Position: " + position.x + " " + position.y + " " + position.z
            // );
            // console.log(
            //   "Rotation: " + rotation.x + " " + rotation.y + " " + rotation.z
            // );
            // document.getElementById("p1").innerHTML =
            //   "Position: " + position.x + " " + position.y + " " + position.z;
            Pos = position;
            rotat = rotation;
            mx = matrix;

            // window.parent.passPos(position);
          };
        })()
      });
    </script>
    <!--     <script>
      AFRAME.registerComponent("track-camera", {
        tick: (function() {
          const position = new THREE.Vector3();
          const direction = new THREE.Vector3();
          const rotation = new THREE.Quaternion();
          const euler = new THREE.Euler();
          const matrix = new THREE.Matrix4();

          return function() {
            this.el.object3D.updateMatrixWorld();
            position.setFromMatrixPosition(this.el.object3D.matrixWorld); // Vector3
            rotation.setFromRotationMatrix(
              matrix.extractRotation(this.el.object3D.matrixWorld)
            );
            var e = this.el.object3D.matrixWorld.elements;
            direction.set(e[8], e[9], e[10]).normalize();

            console.log(
              "Position: " + position.x + " " + position.y + " " + position.z
            );
            console.log(
              "Rotation: " + rotation.x + " " + rotation.y + " " + rotation.z
            );
            console.log(
              "Direction: " +
                direction.x +
                " " +
                direction.y +
                " " +
                direction.z
            );
            document.getElementById("p1").innerHTML = "Position: " + position.x + " " + position.y + " " + position.z;
          };
        })()
      });
    </script> -->
  </head>
  <body style="margin : 0px; overflow: hidden;">
    <div style="margin: auto; text-align: center; z-index: 1;">
      <!--       <p id="p0">CGGGGGGGGGGGGGGGGGGGGGGGGGG</p> -->
      <p id="p1">Hello World!</p>
    </div>

    <a-scene embedded arjs>
      <a-marker preset="hiro" track-camera size="0.1">
        <a-entity scale="1 1 1">
          <a-box position="-1 0 0" rotation="0 45 0" color="#4CC3D9"></a-box>
          <a-cylinder
            position="1 0 0"
            radius="0.5"
            height="1.5"
            color="#FFC65D"
          ></a-cylinder>
          <a-plane
            position="0 0 0"
            rotation="-90 0 0"
            width="1"
            height="1"
            color="blue"
          ></a-plane>
        </a-entity>
      </a-marker>
      <a-box position="0 0 0" rotation="0 0 0" color="#4CC3D9"></a-box>

      <!--       <a-sky color="#ECECEC"></a-sky> -->
      <a-entity camera></a-entity>
    </a-scene>
  </body>
</html>